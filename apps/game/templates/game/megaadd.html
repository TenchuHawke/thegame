<!DOCTYPE html>
<html>
{% load static %}

<head>
    <meta charset="utf-8">
    <title>MegaAdd</title>
    <link rel="stylesheet" type="text/css" href="{% static 'game/css/megaadd.css' %}" />
    <script src="{% static 'game/js/megaadd.js' %}"></script>
</head>

<body>
    <div id="loginblock">
        {% if request.session.user_id %}
        <p></p>
        Hello {{request.session.username}} {# TODO logged in logic#}
        <p></p>
        <p></p>
        <form action="/Login/logout/" method="post">
            {% csrf_token %}
            <button type="submit" name="login">Log out</button>

        </form>
        {% else %}
        <p></p>
        <p>Please Log in</p>
        <p></p>
        <p></p>
        {# TODO not logged in logic#}
        <form action="login" method="post">
            {% csrf_token %}
            <button type="submit" name="login">Log in</button>

        </form>
        {% endif %}
    </div>
    <h2>Users</h2>
    <form class="box" action="game/updateCharacter" method="post">

        {% csrf_token %}
        <!-- #TODO (add user function) -->
        <button type="submit" name="button">add user</button>
        <table>
            <tr>
                <th>Name</th>
                <th>E-Mail</th>
                <th>User Level</th>
                <th>Characters</th>

            </tr>
            {% for user in users %}
            <tr>
                <td class="textleft">{{user.username}}</td>
                <td class="textleft">{{user.email}}</td>
                <td>{{user.userlevel}}</td>
                <td>
                    <table class="innertable">
                        {% for character in characters %}
                        <tr>
                            <td class="left">
                                {% if character.owned_by == user %} {{character.name}}
                            </td>
                            {% csrf_token %}
                            <td>
                                <form action="/game/edit_character" method="post">
                                    <button class="right" type="submit">Edit</button>
                                    <input type="hidden" name="character" value="character">
                                </form>
                                {% endif %}
                            </td>
                        </tr>
                        {% endfor %}
                    </table>
                </td>
            </tr>
            {% endfor %}
        </table>
    </form>
    <h2>Characters</h2>
    <form class="box" action="{% url 'Mainmenu:create' %}" method="post">
        {% csrf_token %}
        <div id="inputfield">
            <table>
                <tr>
                    <td class="left">Name: </td>
                    <td class="right"><input type="text" name="char_name" class="boxa"></td>
                </tr>
                <tr>
                    <td class="left">Class: </td>
                    <td class="right"><select name="add_class">
        					<option value="FI">Fighter (+5 strength)</option>
        					<option value="RO">Rogue (+5 dexterity)</option>
        					<option value="WI">Wizard (+5 intelligence)</option>
        				</select></td>
                </tr>
                <tr>
                    <td width=100px>Base Stats: (No mods) </td>
                </tr>
                <tr>
                    <td class="left"></td>
                    <td class="right">Strength: <input type="text" name="strength" value="1"></td>
                </tr>
                <tr>
                    <td class="left"></td>
                    <td class="right">Dexterity:<input type="text" name="dext" value="1"></td>
                </tr>
                <tr>
                    <td class="left"></td>
                    <td class="right">Intelligence:<input type="text" name="intel" value="1"></td>
                </tr>
                <tr>
                    <td class="left"></td>
                    <td class="right">Health:<input type="text" name="health" value="1"></td>
                </tr>
                <tr>
                    <td class="left">Owned By:</td>
                    <td class="right"><select name="owned_by">
                    {%for user in users%}
                    <option value={{user.id}}>{{user.username}}

                    </option>
                    {% endfor %}

                </select>
                </td>
                </tr>
            </table>
            <br>
        </div>
        <div id="fieldlist">

        </div>
        <button type="submit" name="button">add Character</button>
        <table class="stats">
            <tr>
                <th class="textleft">Name</th>
                <th>Class</th>
                <th>Strength</th>
                <th>Dexterity</th>
                <th>Intelligence</th>
                <th>Health</th>
                <th>Gold</th>
                <th>Level</th>
                <th class="textleft">Owned By</th>
            </tr>
            {% for character in characters %}
            <tr>
                <td class="textleft">{{character.name}}</td>
                <td>{{character.cclass}}</td>
                <td>{{character.strength}}</td>
                <td>{{character.dexterity}}</td>
                <td>{{character.intelligence}}</td>
                <td>{{character.health}}</td>
                <td>{{character.gold}}</td>
                <td>{{character.level}}</td>
                <td class="textleft">{{character.owned_by.username}}</td>
            </tr>
            {% endfor %}
        </table>
    </form>
    <h2>Monsters</h2>
    <form class="box" action="add_monster" method="post">
        <table>
            <tr>
                <td class="left">Name: </td>
                <td class="right"><input type="text" name="name"></td>
            </tr>
            <tr>
                <td class="left">Class: </td>
                <td class="right"><select name="mclass">
                    <option value="BR">Brute (+5 Strength)</option>
                    <option value="AS">Assasin (+5 Dexterity)</option>
                    <option value="MA">Mage (+5 Intelligence)</option>
                    <option value="EL">Elite (+5 All Stats)</option>
                </select></td>
            </tr>
            <tr>
                <td class="left">Alive?: </td>
                <td class="right"><select name="alive">
                <option value="True">True</option>
                <option value="False">False</option>
                </select></td>
            </tr>
            <tr>
                    <td width=100px>Base Stats: (No mods) </td>
                </tr>
                <tr>
                <td class="left"></td>
                <td class="right">Strength: <input type="text" name="strength" value="1"></td>
                </tr>
                <tr>
                <td class="left"></td>
                <td class="right">Dexterity:<input type="text" name="dexterity" value="1"></td>
                </tr>
                <tr>
                <td class="left"></td>
                <td class="right">Intelligence:<input type="text" name="intelligence" value="1"></td>
                </tr>
                <tr>
                <td class="left"></td>
                <td class="right">Health:<input type="text" name="health" value="1"></td>
                </tr>
            <tr>
                <td class="left">Image: </td>
                <td class="right"><input type="text" name="image"></td>
            </tr>
        </table>
         {% csrf_token %}
        <button type="submit" name="button">add Monster</button>
    </form>
    <table class="stats">
            <tr>
            <th class="textleft">Name</th>
                <th>Class</th>
                <th>Strength</th>
                <th>Dexterity</th>
                <th>Intelligence</th>
                <th>Health</th>
            <th class="textleft">Image</th>
            <th class="textleft">alive</th>
            <th class="textleft">Locations</th>
            </tr>
            {% for monster in monsters %}
            <tr>
            <td class="textleft">{{monster.name}}</td>
                <td>{{monster.mclass}}</td>
                <td>{{monster.strength}}</td>
                <td>{{monster.dexterity}}</td>
                <td>{{monster.intelligence}}</td>
                <td>{{monster.health}}</td>
            <td class="textleft">{{monster.image}}</td>
            <td class="textleft">{{monster.alive}}</td>
            <td>
                <table class="innertable">
                    <tr>
                        <th class="textleft">In rooms:</th>
                    </tr>
                    <tr>
                        <tr>{% for room in rooms %} 
                        {% for room_mn in room.monster.all%} 
                        {% if room_mn.id == monster.id%}
                            <td class="textleft">{{room.name}}</td>
                            {% endif %} {% endfor %}
                        </tr>
                        {% endfor %}
                    </tr>
                </table>
            </td>
            </tr>
            {% endfor %}
        </table>

    <h2>Items</h2>
    <form class="box" action="add_item" method="post">
        <table>
            <tr>
                <td class="left">Name: </td>
                <td class="right"><input type="text" name="name"></td>
            </tr>
            <tr>
                <td class="left">Strength Bonus: </td>
                <td class="right"><input type="number" name="strbonus"></td>
            </tr>
            <tr>
                <td class="left">Dexterity Bonus: </td>
                <td class="right"><input type="number" name="dexbonus"></td>
            </tr>
            <tr>
                <td class="left">Intelligence Bonus:</td>
                <td class="right"><input type="number" name="intbonus"></td>
            </tr>
            <tr>
                <td class="left">Health Bonus: </td>
                <td class="right"><input type="number" name="hthbonus"></td>
            </tr>
            <tr>
                <td class="left">Consumeable?: </td>
                <td class="right"><select name="consumeable">
                <option value="False">False</option>
                <option value="True">True</option>
                </select></td>
            </td>
        </table>
        {% csrf_token %}
        <button type="submit" name="button">add Items</button>
    </form>
    <table class="stats">
            <tr>
            <th class="textleft">Name</th>
            <th>Strength Bonus</th>
            <th>Dexterity Bonus</th>
            <th>Intelligence Bonus</th>
                <th>Health Bonus</th>
            <th>Consumeable</th>
            </tr>
            {% for item in items %}
            <tr>
            <td class="textleft">{{item.name}}</td>
                <td>{{item.strbonus}}</td>
                <td>{{item.dexbonus}}</td>
                <td>{{item.intbonus}}</td>
                <td>{{item.hthbonus}}</td>
                <td>{{item.consumeable}}</td>
                <td>
                    <table>
                        {% for owners in Items.owned_by %}
                        <tr>
                            {{owners.name}}
                        </tr>
                        {% endfor %}
                    </table>
                </td>
            </tr>
            {% endfor %}
        </table>

    <h2>Treasure</h2>
    <form class="box" action="add_treasure" method="post">
        <table>
            <tr>
                <td class="left">Name: </td>
                <td class="right"><input type="text" name="name"></td>
            </tr>
            <tr>
                <td class="left">Gold: </td>
                <td class="right"><input type="number" name="gold"></td>
            </tr>
            <tr>
                <td class="left">Item: </td>
                <td class="right"><select name="item">{% for items in items %}
                    <option value="{{items.id}}">{{items.name}}</option>{% endfor %}
                    </select></td>
            </tr>
        </table>
        {% csrf_token %}
        <button type="submit" name="button">add Treasure</button>
        <table class="stats">
            <tr>
                <th class="textleft">Name</th>
                <th>Gold</th>
                <th>Item</th>
                <th class="textleft">Location</th>
            </tr>
            {% for treasure in treasures %}
            <tr>
                <td class="textleft">{{treasure.name}}</td>
                <td>{{treasure.gold}}</td>
                <td>
                    {{treasure.item.name}}
                    <td>
                        <table class="innertable">
                            <tr>
                                <th class="textleft">In rooms:</th>
                            </tr>
                            <tr>
                                <tr>
                                    {% for room in rooms %} {% for room_tr in room.treasure.all%} {% if room_tr.id == treasure.id%}
                                    <td class="textleft">{{room.name}}</td>
                                    {% endif %} {% endfor %}
                                </tr>
                                {% endfor %}
                            </tr>
                        </table>
                    </td>
            </tr>
            {% endfor %}
        </table>
    </form>
    <h2>Traps</h2>
    <form class="box" action="add_trap" method="post">
        <table>
            <tr>
                <td class="left">Name: </td>
                <td class="right"><input type="text" name="name"></td>
            </tr>
            <tr>
                <td class="left">Class: </td>
                <td class="right"><select name="tclass">
                <option value="PZ">Puzzle</option>
                <option value="PS">Poison</option>
                <option value="RF">Reflex</option>
                <option value="CL">Collapse</option>
                </select></td>
            </tr>
            <tr>
                <td class="left">Strength: </td>
                <td class="right"><input type="number" name="strength"></td>
            </tr>
        </table>
        {% csrf_token %}
        <button type="submit" name="button">add Trap</button>
        <table class="stats">
            <tr>
                <th class="textleft">Name</th>
                <th>Class</th>
                <th>Strength</th>
                <th class="textleft">Location</th>
            </tr>
            {% for trap in traps %}
            <tr>
                <td class="textleft">{{trap.name}}</td>
                <td>{{trap.tclass}}</td>
                <td>{{trap.strength}}</td>
                <td>
                    <table class="innertable">
                        <tr>
                            <th class="textleft">In rooms:</th>
                        </tr>
                        <tr>
                        <tr>
                                {% for room in rooms %} {% for room_tr in room.trap.all%} {% if room_tr.id == trap.id%}
                                <td class="textleft">{{room.name}}</td>
                                {% endif %} {% endfor %}
                        </tr>
                        {% endfor %}
                        </tr>
                    </table>
                </td>
            </tr>
            {% endfor %}
        </table>
    </form>
        <h2>Rooms</h2>
        <form class="box" action="add_room" method="post">
            <table>
                <tr>
                <td class="left">Name: </td>
                <td class="right"><input type="text" name="name"></td>
                </tr>
                <tr>
                <td class="left">Description: </td>
                <td class="right"><textarea name="description" rows="5"></textarea></td>
                </tr>
                <tr>
                <td class="left">Terrain Type: </td>
                <td class="right"><input type="text" name="terrain_type"></td>
                </tr>
            </table>
            {% csrf_token %}
            <button type="submit" name="button">add Room</button>
        </form>
        <table class="stats">
                <tr>
                    <th>Name</th>
                    <th>Description</th>
                    <th>Monster</th>
                    <th>Traps</th>
                    <th>Treasures</th>
                    <th>Currently In</th>
                    <th>Explored By</th>
                    <th>Entrances</th>
                    <th>Exits</th>
                </tr>
                <tr>
                    {% for room in rooms %}
                <td class="textleft">{{room.name}}</td>
                <td class="textleft">{{room.description}}</td>
                    <td>
                    <table class="innertable">
                            {% for monster in monsters %}
                            <tr>
                            {%for monster_rm in room.monster.all %}
                            <td class="textleft">{% if monster_rm.id == monster.id %}{{monster.name}} </td>
                            <td>

                                <form action="/game/remove_monster" method="post">
                                    <input type="hidden" name="monster" value="{{monster}}">
                                    <input type="hidden" name="room" value="{{room}}">
                                    <button type="submit">Remove</button></form>{%endif%}</td>
                            </tr>
                        {% endfor %} {% endfor %}
                            <tr>
                                <td><form action="/game/room_monster" method="post">
                                {% csrf_token %}
                                <button type="submit" name="login">Add Monster</button></form></td>
                            </tr>
                        </table>
                    </td>
                    <td>
                    <table class="innertable">
                            {% for trap in traps %}
                            <tr>
                                <td>{% if trap.id == room.trap.id %} {{trap.name}}{%endif%}</td>
                            </tr>
                            {% endfor %}
                            <tr>
                                <td><a href="room_trap/{{room.id}}">Add Trap</a></td>
                            </tr>
                        </table>
                    </td>
                    <td>
                    <table class="innertable">
                            {% for treasure in treasures %}
                            <tr>
                                <td>{% if treasure.id == room.treasure.id %} {{treasure.name}}{%endif%}</td>
                            </tr>
                            {% endfor %}
                            <tr>
                                <td><a href="room_treasure/{{room.id}}">Add Treasure</a></td>
                            </tr>
                        </table>
                    </td>
                    <td>
                    <table class="innertable">
                            {% for character in characters %}
                            <tr>
                                <td>{% if character.id == room.currently_in.id %} {{character.name}}{%endif%}</td>
                            </tr>
                            {% endfor %}
                            <tr>
                                <td><a href="room_visitor/{{room.id}}">Add Characters</a></td>
                            </tr>
                        </table>
                    </td>
                    <td>
                    <table class="innertable">
                            {% for character in characters %}
                            <tr>
                                <td>{% if character.id == room.explored_by.id %} {{character.name}}{%endif%}</td>
                            </tr>
                            {% endfor %}
                            <tr>
                                <td><a href="room_explored/{{room.id}}">Add Characters</a></td>
                            </tr>
                        </table>
                    </td>
                    <td>
                    <table class="innertable">
                            {% for exit in exits %}
                            <tr>
                                <td>{% if comes_from.id == room.id %} {{exits.comes_from.name}}{%endif%}</td>
                            </tr>
                            {% endfor %}
                            <tr>
                                <td><a href="room_enterance/{{room.id}}">Add Enterance</a></td>
                            </tr>
                        </table>
                    </td>
                    <td>
                    <table class="innertable">
                            {% for exit in exits %}
                            <tr>
                                <td>{% if leads_to.id == room.id %} {{exits.leads_to.name}}{%endif%}</td>
                            </tr>
                            {% endfor %}
                            <tr>
                                <td><a href="room_exit/{{room.id}}">Add Exits</a></td>
                            </tr>
                        </table>
                    </td>
                </tr>
                {% endfor %}

            </table>

        </form>


</body>

</html>
